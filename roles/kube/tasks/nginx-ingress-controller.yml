- name: List installed Helm charts.
  command: helm list
  register: helm_list_results
  changed_when: False

- name: Install Nginx Ingress Controller.
  command: >
    helm install stable/nginx-ingress
    --namespace kube-system
    --name nginx-ingress
    -f -
  args:
    stdin: |
      controller:
        config:
          ssl-redirect: "false"
        service:
          type: NodePort
  when: "'nginx-ingress' not in helm_list_results.stdout"
  # do prod params, pin nic version
